(function(){"use strict";var e={4241:function(e,t,n){var o=n(9242),r=n(3396);const a={id:"app"};function i(e,t,n,o,i,s){const l=(0,r.up)("olmap");return(0,r.wg)(),(0,r.iD)("div",a,[(0,r.Wm)(l)])}var s=n(7139);const l=e=>((0,r.dD)("data-v-0cb6c328"),e=e(),(0,r.Cn)(),e),c=l((()=>(0,r._)("div",{id:"map",style:{width:"100%",height:"920px"}},null,-1))),u=l((()=>(0,r._)("div",{id:"mouse-position",class:"mouse-position"},null,-1))),d={class:"button-container"},p={style:{position:"fixed","z-index":"9999",color:"red","font-size":"30px",top:"20vh",left:"20vw"}};function h(e,t,n,o,a,i){return(0,r.wg)(),(0,r.iD)("div",null,[c,u,(0,r._)("div",d,[(0,r._)("button",{onClick:t[0]||(t[0]=(...e)=>i.startDrawingPolygon&&i.startDrawingPolygon(...e))},"AREA")]),(0,r._)("div",p,(0,s.zw)(e.name),1)])}n(1827);var m=n(4945),w=n(270),f=n(1739),y=n(225),g=n(7736),v=n(8537),b=n(8039),Z=n(6553),S=n(1217),P=n(5074),O=n(7745),x=n(4404),L=n(7081),I=n(2205),M=n(7712),_=n(9966),C=n(6677),E=n(9806),k={name:"OpenLayersMap",data(){return{map:null,points:[],mousePosition:null,drawnPolygon:null,drawInteraction:null,popup:null,tileLayer:null}},methods:{createMap(){let e=new E.Z({className:"ol-overviewmap ol-custom-overviewmap",layers:[new b.Z({source:new y.Z({url:"http://wprd0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=7&x={x}&y={y}&z={z}"})})],view:new m.ZP({projection:"EPSG:4326"}),collapseLabel:"»",label:"«",collapsed:!1});this.map=new w.Z({target:"map",layers:[new b.Z({title:"OpenStreetMap",source:new f.Z({})})],view:new m.ZP({center:[116.68,40.41],projection:"EPSG:4326",zoom:16,minZoom:6,maxZoom:20})}),this.map.addControl(e);const t=new C.Z({collapsed:!0,trash:!0});this.map.addControl(t)},addMousePositionControl(){const e=new v.Z({coordinateFormat:function(e){return(0,g.WU)(e,"经度:{x} 纬度:{y}",4)},projection:"EPSG:4326",className:"custom-mouse-position",target:document.getElementById("mouse-position"),undefinedHTML:"&nbsp;"});this.map.addControl(e)},addLayers(){const e=new b.Z({title:"天地图矢量图",source:new y.Z({url:"http://t4.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=61aa1b056de7db1906d3b43d30a71f15"})}),t=new b.Z({title:"天地图影像图",source:new y.Z({url:"http://t0.tianditu.com/DataServer?T=img_w&x={x}&y={y}&l={z}&tk=61aa1b056de7db1906d3b43d30a71f15"})});this.map.addLayer(e),this.map.addLayer(t)},loadGeoserverMap(){this.tileLayer=new b.Z({title:"OSM",source:new Z.Z({url:"http://localhost:8080/geoserver/UCAS/wms",params:{LAYERS:"UCAS:OSMUCAS",TILED:!0},serverType:"geoserver"})}),this.wmsLayer=this.tileLayer,this.map.addLayer(this.tileLayer);const e=new L.Z({layers:[this.tileLayer]});this.map.addInteraction(e),e.on("select",this.onFeatureSelect)},onFeatureSelect(e){const t=e.target.getFeatures();t.forEach((e=>{e.setStyle(this.getHighlightedStyle())}))},getHighlightedStyle(){return new I.ZP({stroke:new _.Z({color:"yellow",width:3}),fill:new M.Z({color:"rgba(255, 255, 0, 0.2)"})})},startDrawingPolygon(){this.drawInteraction=new P.ZP({source:new S.Z,type:"Polygon"}),this.map.addInteraction(this.drawInteraction),this.drawInteraction.on("drawend",this.onDrawEnd)},onDrawEnd(e){const t=e.feature,n=t.getGeometry(),o=n.getCoordinates();console.log("Polygon coordinates:",o);const r=(0,O.bg)(n,{projection:"EPSG:4326",radius:6378137}),a=r/1e6;let i;i=r>1e4?Math.round(100*a)/100+" km<sup>2</sup>":Math.round(100*a)/100+" m<sup>2</sup>",console.log("Polygon area:",i);const s=n.getExtent(),l=(0,x.oJ)(s),c=l.getInteriorPoint().getCoordinates();console.log("Polygon center:",c),alert(`多边形面积：${r.toFixed(2)} 平方米`),this.map.removeInteraction(this.drawInteraction),this.drawInteraction=null},clickFeature(){this.map.on("dblclick",(async e=>{let t=this.map.getView().getResolution(),n=this.wmsLayer.getSource().getFeatureInfoUrl(e.coordinate,t,"EPSG:4326",{INFO_FORMAT:"application/json"});if(n){let e=await fetch(n).then((function(e){return e.text()}));Array.isArray(JSON.parse(e).features)&&JSON.parse(e).features.length>0?(console.log("JSON.parse(data):",JSON.parse(e)),this.name=JSON.parse(e).features[0].properties.name,alert(this.name)):alert("wrong positin")}}))}},mounted(){this.createMap(),this.addLayers(),this.addMousePositionControl(),this.loadGeoserverMap(),this.clickFeature()}},j=n(89);const D=(0,j.Z)(k,[["render",h],["__scopeId","data-v-0cb6c328"]]);var F=D,z={name:"app",components:{olmap:F}};const A=(0,j.Z)(z,[["render",i]]);var G=A;(0,o.ri)(G).mount("#app")}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,a){if(!o){var i=1/0;for(u=0;u<e.length;u++){o=e[u][0],r=e[u][1],a=e[u][2];for(var s=!0,l=0;l<o.length;l++)(!1&a||i>=a)&&Object.keys(n.O).every((function(e){return n.O[e](o[l])}))?o.splice(l--,1):(s=!1,a<i&&(i=a));if(s){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[o,r,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,a,i=o[0],s=o[1],l=o[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(l)var u=l(n)}for(t&&t(o);c<i.length;c++)a=i[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},o=self["webpackChunkvue_openlayers"]=self["webpackChunkvue_openlayers"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(4241)}));o=n.O(o)})();
//# sourceMappingURL=app.72834919.js.map